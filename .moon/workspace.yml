# Trigger CI: 25

$schema: '../website/static/schemas/workspace.json'

projects:
  # sources:
  #   moon: '.'
  sources: {}
  globs:
    - './packages/*'
    - '!packages/cli'
    - '!packages/core-*'
    - 'website'

generator:
  templates:
    # - './.moon/templates'
    - './tests/fixtures/generator/templates'

runner:
  archivableTargets:
    - ':lint'
    - ':test'
    - ':typecheck'
  logRunningCommand: true

vcs:
  defaultBranch: 'master'
  # hooks:
  #   pre-commit:
  #     - 'cargo run -- run :lint'

docker:
  scaffold:
    include:
      - '*.config.js'
      - '*.json'
unstable_remote:
  # host: 'http://0.0.0.0:8080'
  # host: 'grpcs://0.0.0.0:9092'
  host: 'grpcs://cache.depot.dev'
  auth:
    token: 'DEPOT_TOKEN'
    headers:
      Authorization:
        'Bearer depot_org_ece2365d877c7f2f437f46de5bf03bd54862e3ca7fde67f079264e971ecb0789'
      'X-Depot-Org': '1xtpjd084j'
      'X-Depot-Project': '90xxfkst9n'
  # cache:
  #   compression: 'zstd'
  # mtls:
  #   caCert: 'crates/remote/tests/__fixtures__/certs-local/ca.pem'
  #   clientCert: 'crates/remote/tests/__fixtures__/certs-local/client.pem'
  #   clientKey: 'crates/remote/tests/__fixtures__/certs-local/client.key'
  #   domain: 'localhost'
  # tls:
  #   # assumeHttp2: true
  #   cert: 'crates/remote/tests/__fixtures__/certs-local/client.pem'
  #   domain: 'localhost'
